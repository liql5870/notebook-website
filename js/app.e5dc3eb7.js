(function(t){function e(e){for(var n,i,a=e[0],c=e[1],u=e[2],l=0,f=[];l<a.length;l++)i=a[l],Object.prototype.hasOwnProperty.call(r,i)&&r[i]&&f.push(r[i][0]),r[i]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(t[n]=c[n]);d&&d(e);while(f.length)f.shift()();return s.push.apply(s,u||[]),o()}function o(){for(var t,e=0;e<s.length;e++){for(var o=s[e],n=!0,a=1;a<o.length;a++){var c=o[a];0!==r[c]&&(n=!1)}n&&(s.splice(e--,1),t=i(i.s=o[0]))}return t}var n={},r={app:0},s=[];function i(e){if(n[e])return n[e].exports;var o=n[e]={i:e,l:!1,exports:{}};return t[e].call(o.exports,o,o.exports,i),o.l=!0,o.exports}i.m=t,i.c=n,i.d=function(t,e,o){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(i.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(o,n,function(e){return t[e]}.bind(null,n));return o},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],c=a.push.bind(a);a.push=e,a=a.slice();for(var u=0;u<a.length;u++)e(a[u]);var d=c;s.push([0,"chunk-vendors"]),o()})({0:function(t,e,o){t.exports=o("cd49")},2025:function(t,e,o){"use strict";o("da06")},"43e7":function(t,e,o){},5156:function(t,e,o){"use strict";o("5aec")},"5aec":function(t,e,o){},"5c0b":function(t,e,o){"use strict";o("9c0c")},"5c8d":function(t,e,o){},"5c98":function(t,e,o){},"619c":function(t,e,o){"use strict";o("5c8d")},"6d8e":function(t,e,o){"use strict";o("9bf8")},8951:function(t,e,o){"use strict";o("43e7")},8985:function(t,e,o){"use strict";o("5c98")},"8ff9":function(t,e,o){"use strict";o("999b")},"999b":function(t,e,o){},"9bf8":function(t,e,o){},"9c0c":function(t,e,o){},cd49:function(t,e,o){"use strict";o.r(e);o("e260"),o("e6cf"),o("cca6"),o("a79d");var n=o("2b0e"),r=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{attrs:{id:"app"}},[o("sidebar"),o("router-view"),o("div",{attrs:{id:"nav"}})],1)},s=[],i=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{attrs:{id:"sidebar"}},[o("avatar"),o("div",{staticClass:"icons"},[o("router-link",{attrs:{to:"/note",title:"笔记"}},[o("i",{staticClass:"iconfont icon-note"})]),o("router-link",{attrs:{to:"/notebooks",title:"笔记本"}},[o("i",{staticClass:"iconfont icon-notebook"})]),o("router-link",{attrs:{to:"/trash",title:"回收站"}},[o("i",{staticClass:"iconfont icon-trash"})])],1),o("div",{staticClass:"logout"},[o("i",{staticClass:"iconfont icon-logout",attrs:{title:"退出"},on:{click:t.logout}})])],1)},a=[],c=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("span",{attrs:{title:t.username}},[t._v(t._s(t.slug))])},u=[],d=o("5530"),l=o("2f62"),f={data:function(){return{}},created:function(){this.setUser()},methods:Object(d["a"])({},Object(l["b"])({setUser:"checkLogin"})),computed:Object(d["a"])({},Object(l["c"])(["username","slug"]))},h=f,p=(o("8ff9"),o("2877")),v=Object(p["a"])(h,c,u,!1,null,"4493ed88",null),m=v.exports,b={components:{avatar:m},methods:{logout:function(){return this.$router.push({path:"./login"})}}},g=b,k=(o("5156"),Object(p["a"])(g,i,a,!1,null,"62c0b6e4",null)),N=k.exports,w={name:"app",components:{sidebar:N},methods:{}},_=w,I=(o("5c0b"),Object(p["a"])(_,r,s,!1,null,null,null)),T=I.exports,C=o("8c4f"),y=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{attrs:{id:"login"}},[o("div",{staticClass:"modal-mask"},[o("div",{staticClass:"modal-wrapper"},[o("div",{staticClass:"modal-container"},[o("div",{staticClass:"main"}),o("div",{staticClass:"form"},[o("h3",{on:{click:t.showRegister}},[t._v("创建账户")]),o("transition",{attrs:{name:"slide"}},[o("div",{staticClass:"register",class:{show:t.isShowRegister}},[o("input",{directives:[{name:"model",rawName:"v-model",value:t.register.username,expression:"register.username"}],attrs:{type:"text",placeholder:"用户名"},domProps:{value:t.register.username},on:{input:function(e){e.target.composing||t.$set(t.register,"username",e.target.value)}}}),o("input",{directives:[{name:"model",rawName:"v-model",value:t.register.password,expression:"register.password"}],attrs:{type:"password",placeholder:"密码"},domProps:{value:t.register.password},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.onRegister.apply(null,arguments)},input:function(e){e.target.composing||t.$set(t.register,"password",e.target.value)}}}),o("p",{class:{error:t.register.isError}},[t._v(" "+t._s(t.register.notice))]),o("div",{staticClass:"button",on:{click:t.onRegister}},[t._v("创建账号")])])]),o("h3",{on:{click:t.showLogin}},[t._v("登录")]),o("transition",{attrs:{name:"slide"}},[o("div",{staticClass:"login",class:{show:t.isShowLogin}},[o("input",{directives:[{name:"model",rawName:"v-model",value:t.login.username,expression:"login.username"}],attrs:{type:"text",placeholder:"输入用户名"},domProps:{value:t.login.username},on:{input:function(e){e.target.composing||t.$set(t.login,"username",e.target.value)}}}),o("input",{directives:[{name:"model",rawName:"v-model",value:t.login.password,expression:"login.password"}],attrs:{type:"password",placeholder:"密码"},domProps:{value:t.login.password},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.onLogin.apply(null,arguments)},input:function(e){e.target.composing||t.$set(t.login,"password",e.target.value)}}}),o("p",{class:{error:t.login.isError}},[t._v(" "+t._s(t.login.notice))]),o("div",{staticClass:"button",on:{click:t.onLogin}},[t._v(" 登录")])])])],1)])])])])},E=[],O=(o("ac1f"),o("00b4"),{data:function(){return{isShowLogin:!0,isShowRegister:!1,login:{username:"",password:"",notice:"输入用户名和密码",isError:!1},register:{username:"",password:"",notice:"创建账号后，请记住用户名和密码",isError:!1}}},methods:Object(d["a"])(Object(d["a"])({},Object(l["b"])({loginUser:"login",registerUser:"register"})),{},{showLogin:function(){this.isShowLogin=!0,this.isShowRegister=!1},showRegister:function(){this.isShowLogin=!1,this.isShowRegister=!0},onRegister:function(){var t=this;return/^[\w\u4e00-\u9fa5]{3,15}$/.test(this.register.username)?/^.{6,16}$/.test(this.register.password)?void this.registerUser({username:this.register.username,password:this.register.password}).then((function(){t.register.isError=!1,t.register.notice="",t.$router.push({path:"notebooks"})})).catch((function(e){t.register.isError=!0,t.register.notice=e.msg})):(this.register.isError=!0,void(this.register.notice="密码长度为6~16个字符")):(this.register.isError=!0,void(this.register.notice="用户名3~15个字符，仅限于字母数字下划线中文"))},onLogin:function(){var t=this;return/^[\w\u4e00-\u9fa5]{3,15}$/.test(this.login.username)?/^.{6,16}$/.test(this.login.password)?void this.loginUser({username:this.login.username,password:this.login.password}).then((function(){t.login.isError=!1,t.login.notice="",t.$router.push({path:"notebooks"})})).catch((function(e){t.login.isError=!0,t.login.notice=e.msg})):(this.login.isError=!0,void(this.login.notice="密码长度为6~16个字符")):(this.login.isError=!0,void(this.login.notice="用户名3~15个字符，仅限于字母数字下划线中文"))}})}),A=O,j=(o("6d8e"),Object(p["a"])(A,y,E,!1,null,"9edc038c",null)),x=j.exports,P=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"detail",attrs:{id:"notebook-list"}},[o("header",[o("a",{staticClass:"btn",attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),t.onCreate.apply(null,arguments)}}},[o("i",{staticClass:"iconfont icon-plus"}),t._v(" 新建笔记本")])]),o("main",[o("div",{staticClass:"layout"},[o("h3",[t._v("笔记本列表("+t._s(t.notebooks.length)+")")]),o("div",{staticClass:"book-list"},t._l(t.notebooks,(function(e){return o("router-link",{key:e.id,staticClass:"notebook",attrs:{to:"/note?notebookId="+e.id}},[o("div",[o("span",{staticClass:"iconfont icon-notebook"}),t._v(" "+t._s(e.title)+" "),o("span",[t._v(t._s(e.noteCounts))]),o("span",{staticClass:"action",on:{click:function(o){return o.stopPropagation(),o.preventDefault(),t.onEdit(e)}}},[t._v("编辑")]),o("span",{staticClass:"action",on:{click:function(o){return o.stopPropagation(),o.preventDefault(),t.onDelete(e)}}},[t._v("删除")]),o("span",{staticClass:"date"},[t._v(t._s(e.friendlyCreatedAt))])])])})),1)])])])},$=[],L={data:function(){return{}},created:function(){this.checkLogin({path:"/login"}),this.getNotebooks(),console.log("显示正常码")},computed:Object(d["a"])({},Object(l["c"])(["notebooks"])),methods:Object(d["a"])(Object(d["a"])({},Object(l["b"])(["getNotebooks","addNotebook","updateNotebook","deleteNotebook","checkLogin"])),{},{onCreate:function(){var t=this;this.$prompt("输入新笔记本标题","创建笔记本",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/^.{1,30}$/,inputErrorMessage:"标题不能为空，且不超过30个字符"}).then((function(e){var o=e.value;t.addNotebook({title:o})}))},onEdit:function(t){var e=this;this.$prompt("输入新笔记本标题","修改笔记本",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/^.{1,30}$/,inputValue:t.title,inputErrorMessage:"标题不能为空，且不超过30个字符"}).then((function(o){var n=o.value;e.updateNotebook({notebookId:t.id,title:n})}))},onDelete:function(t){var e=this;this.$confirm("确认要删除笔记本吗","删除笔记本",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.deleteNotebook({notebookId:t.id})}))}})},B=L,D=(o("619c"),Object(p["a"])(B,P,$,!1,null,"122afd09",null)),S=D.exports,M=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"detail",attrs:{id:"note"}},[o("note-sidebar",{on:{"update:notes":function(e){return t.notes=e}}}),o("div",{staticClass:"note-detail"},[o("div",{directives:[{name:"show",rawName:"v-show",value:!t.curBook.id,expression:"!curBook.id"}],staticClass:"note-empty"},[t._v("请创建笔记本后")]),o("div",{directives:[{name:"show",rawName:"v-show",value:!t.curNote.id,expression:"!curNote.id"}],staticClass:"note-empty"},[t._v("选择或创建笔记")]),o("div",{directives:[{name:"show",rawName:"v-show",value:t.curNote.id,expression:"curNote.id"}],staticClass:"note-detail-ct"},[o("div",{staticClass:"note-bar"},[o("span",[t._v(" 创建日期: "+t._s(t.curNote.createdAtFriendly))]),o("span",[t._v(" 更新日期: "+t._s(t.curNote.updatedAtFriendly))]),o("span",[t._v(" "+t._s(t.statusText))]),o("span",{staticClass:"iconfont icon-delete",on:{click:t.onDeleteNote}}),o("span",{staticClass:"iconfont",class:t.isShowPreview?"icon-edit":"icon-eye",on:{click:function(e){t.isShowPreview=!t.isShowPreview}}})]),o("div",{staticClass:"note-title"},[o("input",{directives:[{name:"model",rawName:"v-model",value:t.curNote.title,expression:"curNote.title"}],attrs:{type:"text",placeholder:"输入标题"},domProps:{value:t.curNote.title},on:{input:[function(e){e.target.composing||t.$set(t.curNote,"title",e.target.value)},t.onUpdateNote],keydown:function(e){t.statusText="正在输入..."}}})]),o("div",{staticClass:"editor"},[o("codemirror",{directives:[{name:"show",rawName:"v-show",value:!t.isShowPreview,expression:"!isShowPreview"}],attrs:{options:t.cmOptions},on:{input:t.onUpdateNote,inputRead:function(e){t.statusText="正在输入..."}},model:{value:t.curNote.content,callback:function(e){t.$set(t.curNote,"content",e)},expression:"curNote.content"}}),o("div",{directives:[{name:"show",rawName:"v-show",value:!t.isShowPreview,expression:"!isShowPreview"}],staticClass:"preview markdown-body",domProps:{innerHTML:t._s(t.previewContent)}})],1)])])],1)},R=[],U=(o("5319"),function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"note-sidebar"},[o("span",{staticClass:"btn add-note",on:{click:t.onAddNote}},[t._v("添加笔记")]),t.curBook.id?t._e():o("span",{staticClass:"notebook-title"},[t._v("无笔记本")]),t.curBook.id?o("el-dropdown",{staticClass:"notebook-title",attrs:{placement:"bottom"},on:{command:t.handleCommand}},[o("span",{staticClass:"el-dropdown-link"},[t._v(" "+t._s(t.curBook.title)+" "),o("i",{staticClass:"iconfont icon-down"})]),o("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[t._l(t.notebooks,(function(e){return o("el-dropdown-item",{key:e.id,attrs:{command:e.id}},[t._v(t._s(e.title)+" ")])})),o("el-dropdown-item",{attrs:{command:"trash"}},[t._v("回收站")])],2)],1):t._e(),t._m(0),o("ul",{staticClass:"notes"},t._l(t.notes,(function(e){return o("li",{key:e.id},[o("router-link",{attrs:{to:"/note?noteId="+e.id+"&notebookId="+t.curBook.id}},[o("span",{staticClass:"date"},[t._v(t._s(e.updatedAtFriendly))]),o("span",{staticClass:"title"},[t._v(t._s(e.title))])])],1)})),0)],1)}),F=[function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"menu"},[o("div",[t._v("更新时间")]),o("div",[t._v("标题")])])}],G={created:function(){var t=this;this.getNotebooks().then((function(){if(t.setCurBook({curBookId:t.$route.query.notebookId}),t.curBook.id)return t.getNotes({notebookId:t.curBook.id})})).then((function(){t.setCurNote({curNoteId:t.$route.query.noteId}),t.$router.replace({path:"/note",query:{noteId:t.curNote.id,notebookId:t.curBook.id}})}))},data:function(){return{}},computed:Object(d["a"])({},Object(l["c"])(["notebooks","notes","curBook","curNote"])),methods:Object(d["a"])(Object(d["a"])(Object(d["a"])({},Object(l["d"])(["setCurBook","setCurNote"])),Object(l["b"])(["getNotebooks","getNotes","addNote"])),{},{handleCommand:function(t){var e=this;if("trash"===t)return this.$router.push({path:"/trash"});this.$store.commit("setCurBook",{curBookId:t}),this.getNotes({notebookId:t}).then((function(){e.setCurNote(),e.$router.replace({path:"/note",query:{noteId:e.curNote.id,notebookId:e.curBook.id}})}))},onAddNote:function(){this.addNote({notebookId:this.curBook.id})}})},q=G,H=(o("8985"),Object(p["a"])(q,U,F,!1,null,"61cc97e4",null)),V=H.exports,J=o("2ef0"),z=o.n(J),K=o("d4cd"),Q=o.n(K),W=o("8f94"),X=(o("a7be"),o("959b"),o("bbca"),new Q.a),Y={components:{NoteSidebar:V,codemirror:W["codemirror"]},data:function(){return{statusText:"笔记未改动",isShowPreview:!1,cmOptions:{tabSize:4,mode:"text/x-markdown",theme:"neat",lineNumbers:!1,line:!0}}},created:function(){this.checkLogin({path:"/login"})},computed:Object(d["a"])(Object(d["a"])({},Object(l["c"])(["notes","curNote","curBook"])),{},{previewContent:function(){return X.render(this.curNote.content||"")}}),methods:Object(d["a"])(Object(d["a"])(Object(d["a"])({},Object(l["d"])(["setCurNote"])),Object(l["b"])(["updateNote","deleteNote","checkLogin"])),{},{onUpdateNote:z.a.debounce((function(){var t=this;this.curNote.id&&this.updateNote({noteId:this.curNote.id,title:this.curNote.title,content:this.curNote.content}).then((function(e){t.statusText="已保存"})).catch((function(e){t.statusText="保存出错"}))}),3e3),onDeleteNote:function(){var t=this;this.deleteNote({noteId:this.curNote.id}).then((function(e){t.$router.replace({path:"/note"})}))}}),beforeRouteUpdate:function(t,e,o){this.setCurNote({curNoteId:t.query.noteId}),o()}},Z=Y,tt=(o("2025"),Object(p["a"])(Z,M,R,!1,null,"27f29362",null)),et=tt.exports,ot=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"detail",attrs:{id:"trash"}},[o("div",{staticClass:"note-sidebar"},[o("h3",{staticClass:"notebook-title"},[t._v("回收站")]),t._m(0),o("ul",{staticClass:"notes"},t._l(t.trashNotes,(function(e){return o("li",{key:e.id},[o("router-link",{attrs:{to:"/trash?noteId="+e.id}},[o("span",{staticClass:"date"},[t._v(t._s(e.updatedAtFriendly))]),o("span",{staticClass:"title"},[t._v(t._s(e.title))])])],1)})),0)]),o("div",{staticClass:"note-detail"},[o("div",{staticClass:"note-bar"},[o("span",[t._v(" 创建日期: "+t._s(t.curTrashNote.createdAtFriendly))]),o("span",[t._v(" | ")]),o("span",[t._v(" 更新日期: "+t._s(t.curTrashNote.updatedAtFriendly))]),o("span",[t._v(" | ")]),o("span",[t._v(" 所属笔记本: "+t._s(t.belongTo))]),o("a",{staticClass:"btn action",on:{click:t.onRevert}},[t._v("恢复")]),o("a",{staticClass:"btn action",on:{click:t.onDelete}},[t._v("彻底删除")])]),o("div",{staticClass:"note-title"},[o("span",[t._v(t._s(t.curTrashNote.title))])]),o("div",{staticClass:"editor"},[o("div",{staticClass:"preview markdown-body",domProps:{innerHTML:t._s(t.compiledMarkdown)}})])])])},nt=[function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"menu"},[o("div",[t._v("更新时间")]),o("div",[t._v("标题")])])}],rt=new Q.a,st={data:function(){return{}},created:function(){var t=this;this.checkLogin({path:"/login"}),this.getNotebooks(),this.getTrashNotes().then((function(){t.setCurTrashNote({curTrashNoteId:t.$route.query.noteId})}))},computed:Object(d["a"])(Object(d["a"])({},Object(l["c"])(["trashNotes","curTrashNote","belongTo"])),{},{compiledMarkdown:function(){return rt.render(this.curTrashNote.content||"")}}),methods:Object(d["a"])(Object(d["a"])(Object(d["a"])({},Object(l["d"])(["setCurTrashNote"])),Object(l["b"])(["checkLogin","deleteTrashNote","revertTrashNote","getTrashNotes","getNotebooks"])),{},{onDelete:function(){var t=this;this.$confirm("删除后将无法恢复","确定删除？",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){return t.deleteTrashNote({noteId:t.curTrashNote.id})})).then((function(){console.log("delete success"),t.setCurTrashNote(),t.$router.replace({path:"/trash",query:{noteId:t.curTrashNote.id}})}))},onRevert:function(){var t=this;this.revertTrashNote({noteId:this.curTrashNote.id}).then((function(){t.setCurTrashNote(),t.$router.replace({path:"/trash",query:{noteId:t.curTrashNote.id}})}))},beforeRouteUpdate:function(t,e,o){this.setCurTrashNote({curTrashNoteId:t.query.noteId}),o()}})},it=st,at=(o("8951"),Object(p["a"])(it,ot,nt,!1,null,"129f675e",null)),ct=at.exports;n["default"].use(C["a"]);var ut=[{path:"/login",name:"Login",component:x},{path:"/notebooks",name:"notebooks",component:S},{path:"/note",component:et},{path:"/trash",component:ct}],dt=new C["a"]({mode:"history",routes:ut}),lt=dt,ft=(o("7db0"),o("d3b7"),o("4de4"),o("4e82"),o("159b"),o("bc3a")),ht=o.n(ft),pt=o("5c96"),vt=o.n(pt);function mt(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET",o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new Promise((function(n,r){var s={url:t,method:e,validataStatus:function(t){return t>=200&&t<300||400===t}};"get"===e.toLowerCase()?s.params=o:s.data=o,ht()(s).then((function(t){200===t.status?n(t.data):(pt["Message"].error(t.data.msg),r(t.data))})).catch((function(t){pt["Message"].error("网络异常"),r(t)}))}))}ht.a.defaults.baseURL="https://note-server.hunger-valley.com/",ht.a.defaults.withCredentials=!0;var bt=o("53ca");function gt(t){var e="object"===Object(bt["a"])(t)?t:new Date(t),o=e.getTime(),n=Date.now(),r=n-o,s="";switch(!0){case r<6e4:s="刚刚";break;case r<36e5:s=Math.floor(r/6e4)+"分钟前";break;case r<864e5:s=Math.floor(r/36e5)+"小时前";break;case r<2592e6:s=Math.floor(r/864e5)+"天前";break;case r>2592e6&&r<31536e6:s=Math.floor(r/2592e6)+"月前";break;default:s=Math.floor(r/31104e6)+"年前"}return s}var kt={GET:"/notebooks",ADD:"/NOTEBOOKS",UPDATE:"/notebooks/:id",DELETE:"/notebooks/:id"},Nt={getAll:function(){return new Promise((function(t,e){mt(kt.GET).then((function(e){e.data=e.data.sort((function(t,e){return t.createAt-e.createAt})),e.data.forEach((function(t){t.createdAtFriendly=gt(t.createdAt),t.updatedAtFriendly=gt(t.updatedAt)})),t(e)})).catch((function(t){return e(t)}))}))},updateNotebook:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{title:""},o=e.title,n=void 0===o?"":o;return mt(kt.UPDATE.replace(":id",t),"PATCH",{title:n})},deleteNotebook:function(t){return mt(kt.DELETE.replace(":id",t),"DELETE")},addNotebook:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{title:""},e=t.title,o=void 0===e?"":e;return new Promise((function(t,e){mt(kt.ADD,"POST",{title:o}).then((function(e){e.data.createdAtFriendly=gt(e.data.createdAt),e.data.updatedAtFriendly=gt(e.data.updatedAt),t(e)})).catch((function(t){e(t)}))}))}},wt={notebooks:null,curBookId:null},_t={notebooks:function(t){return t.notebooks||[]},curBook:function(t){return Array.isArray(t.notebooks)?t.curBookId?t.notebooks.find((function(e){return e.id===t.curBookId}))||{}:t.notebooks[0]||{}:{}}},It={setNotebooks:function(t,e){t.notebooks=e.notebooks},addNotebook:function(t,e){t.notebooks.unshift(e.notebook)},updateNotebook:function(t,e){var o=t.notebooks.find((function(t){return t.id===e.notebookId}))||{};o.title=e.title},deleteNotebook:function(t,e){t.notebooks=t.notebooks.filter((function(t){return t.id!==e.notebookId}))},setCurBook:function(t,e){t.curBookId=e.curBookId}},Tt={getNotebooks:function(t){var e=t.commit;return Nt.getAll().then((function(t){e("setNotebooks",{notebooks:t.data})}))},addNotebook:function(t,e){var o=t.commit;return Nt.addNotebook({title:e.title}).then((function(t){o("addNotebook",{notebook:t.data}),pt["Message"].success(t.msg)})).catch((function(t){return console.log(t)}))},updateNotebook:function(t,e){var o=t.commit;return Nt.updateNotebook(e.notebookId,{title:e.title}).then((function(t){o("updateNotebook",{notebookId:e.notebookId,title:e.title}),pt["Message"].success(t.msg)}))},deleteNotebook:function(t,e){var o=t.commit;return Nt.deleteNotebook(e.notebookId).then((function(t){o("deleteNotebook",{notebookId:e.notebookId}),pt["Message"].success(t.msg)}))}},Ct={state:wt,getters:_t,mutations:It,actions:Tt},yt=(o("d81d"),{GET:"/notes/from/:notebookId",ADD:"/notes/to/:notebookId",UPDATE:"/notes/:noteId",DELETE:"/notes/:noteId"}),Et={getAll:function(t){var e=t.notebookId;return new Promise((function(t,o){mt(yt.GET.replace(":notebookId",e)).then((function(e){e.data=e.data.map((function(t){return t.createdAtFriendly=gt(t.createdAt),t.updatedAtFriendly=gt(t.updatedAt),t})).sort((function(t,e){return t.updatedAt-e.updatedAt})),t(e)})).catch((function(t){o(t)}))}))},updateNote:function(t,e){var o=t.noteId,n=e.title,r=e.content;return mt(yt.UPDATE.replace(":noteId",o),"PATCH",{title:n,content:r})},deleteNote:function(t){var e=t.noteId;return mt(yt.DELETE.replace(":noteId",e),"DELETE")},addNote:function(t){var e=t.notebookId,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{title:"",content:""},n=o.title,r=void 0===n?"":n,s=o.content,i=void 0===s?"":s;return new Promise((function(t,o){mt(yt.ADD.replace(":notebookId",e),"POST",{title:r,content:i}).then((function(e){e.data.createdAtFriendly=gt(e.data.createdAt),e.data.updatedAtFriendly=gt(e.data.updatedAt),t(e)})).catch((function(t){o(t)}))}))}},Ot={notes:null,curNoteId:null},At={notes:function(t){return t.notes||[]},curNote:function(t){return Array.isArray(t.notes)?t.curNoteId?t.notes.find((function(e){return e.id===t.curNoteId}))||{title:"",content:""}:t.notes[0]||{title:"",content:""}:{title:"",content:""}}},jt={setNote:function(t,e){t.notes=e.notes},addNote:function(t,e){t.notes.unshift(e.note)},updateNote:function(t,e){var o=t.notes.find((function(t){return t.id===e.noteId}))||{};o.title=e.title,o.content=e.content},deleteNote:function(t,e){t.notes=t.notes.filter((function(t){return t.id!==e.noteId}))},setCurNote:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t.curNoteId=e.curNoteId}},xt={getNotes:function(t,e){var o=t.commit,n=e.notebookId;return Et.getAll({notebookId:n}).then((function(t){o("setNote",{notes:t.data})}))},addNote:function(t,e){var o=t.commit,n=e.notebookId,r=e.title,s=e.content;return Et.addNote({notebookId:n},{title:r,content:s}).then((function(t){console.log("add success...",t),o("addNote",{note:t.data})}))},updateNote:function(t,e){var o=t.commit,n=e.noteId,r=e.title,s=e.content;return Et.updateNote({noteId:n},{title:r,content:s}).then((function(t){o("updateNote",{noteId:n,title:r,content:s})}))},deleteNote:function(t,e){var o=t.commit,n=e.noteId;return Et.deleteNotebook({noteId:n}).then((function(t){o("deleteNote",{noteId:n}),pt["Message"].success(t.msg)}))}},Pt={state:Ot,getters:At,mutations:jt,actions:xt},$t={GET:"/notes/trash",REVERT:"/notes/:noteId/revert",DELETE:"/notes/:noteId/confirm"},Lt={getAll:function(){return new Promise((function(t,e){mt($t.GET).then((function(e){e.data=e.data.sort((function(t,e){return t.createdAt-e.createdAt})),e.data.forEach((function(t){t.createdAtFriendly=gt(t.createdAt),t.updatedAtFriendly=gt(t.updatedAt)})),t(e)})).catch((function(t){e(t)}))}))},deleteNote:function(t){var e=t.noteId;return mt($t.DELETE.replace(":noteId",e),"DELETE")},revertNote:function(t){var e=t.noteId;return mt($t.REVERT.replace(":noteId",e),"PATCH")}},Bt={trashNotes:null,curTrashNoteId:null},Dt={trashNotes:function(t){return t.trashNotes||[]},curTrashNote:function(t,e){return t.curTrashNoteId?t.trashNotes.find((function(e){return e.id===t.curTrashNoteId}))||{}:e.trashNotes[0]||{}},belongTo:function(t,e,o,n){var r=n.notebooks.find((function(t){return t.id===e.curTrashNote.notebookId}))||{};return r.title||""}},St={setTrashNotes:function(t,e){t.trashNotes=e.trashNotes},addTrashNote:function(t,e){this.setTrashNotes.unshift(e.note)},deleteTrashNote:function(t,e){t.trashNotes=t.trashNotes.filter((function(t){return t.id!==e.noteId}))},setCurTrashNote:function(t,e){t.curTrashNoteId=e.curTrashNoteId}},Mt={getTrashNotes:function(t){var e=t.commit;return Lt.getAll().then((function(t){e("setTrashNotes",{trashNotes:t.data})}))},deleteTrashNote:function(t,e){var o=t.commit,n=e.noteId;return Lt.deleteNote({noteId:n}).then((function(t){o("deleteTrashNote",{noteId:n}),pt["Message"].success(t.msg)}))},revertTrashNote:function(t,e){var o=t.commit,n=e.noteId;return Lt.revertNote({noteId:n}).then((function(t){o("deleteTrashNote",{noteId:n}),pt["Message"].success(t.msg)}))}},Rt={state:Bt,getters:Dt,mutations:St,actions:Mt},Ut={REGISTER:"/auth/register",LOGIN:"/auth/login",LOGOUT:"/auth/logout",GET_INFO:"/auth"},Ft={register:function(t){var e=t.username,o=t.password;return mt(Ut.REGISTER,"POST",{username:e,password:o})},login:function(t){var e=t.username,o=t.password;return mt(Ut.LOGIN,"POST",{username:e,password:o})},logout:function(){return mt(Ut.LOGOUT)},getInfo:function(){return mt(Ut.GET_INFO)}};window.router=lt;var Gt={user:null},qt={username:function(t){return null===t.user?"未登录":t.user.username},slug:function(t){return null===t.user?"未":t.user.username.charAt(0)}},Ht={setUser:function(t,e){t.user=e.user}},Vt={login:function(t,e){var o=t.commit,n=e.username,r=e.password;return Ft.login({username:n,password:r}).then((function(t){o("setUser",{user:t.data})}))},register:function(t,e){var o=t.commit,n=e.username,r=e.password;return Ft.register({username:n,password:r}).then((function(t){o("setUser",{user:t.data})}))},logout:function(t){var e=t.commit,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{path:"/login"};return Ft.logout().then((function(t){e("setUser",{user:null}),lt.push(o)}))},checkLogin:function(t,e){var o=t.commit;return Ft.getInfo().then((function(t){t.isLogin?o("setUser",{user:t.data}):(console.log("jump"),lt.push(e))}))}},Jt={state:Gt,getters:qt,mutations:Ht,actions:Vt};n["default"].use(l["a"]);var zt=new l["a"].Store({modules:{notebook:Ct,note:Pt,trash:Rt,user:Jt}});o("0fae");n["default"].config.productionTip=!1,n["default"].use(vt.a),new n["default"]({router:lt,store:zt,render:function(t){return t(T)}}).$mount("#app")},da06:function(t,e,o){}});
//# sourceMappingURL=app.e5dc3eb7.js.map